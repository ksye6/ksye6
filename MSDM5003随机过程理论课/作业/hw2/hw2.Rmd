---
title: "HW2"
author: "20989977 Zhang Mingtao"
date: "2023/10/7"
output: html_document
---  
1.
```{r}
#(a)
set.seed(1)
n=500000
Random_Walk=cumsum(sample(c(-1, 1), n, TRUE))
ts.plot(Random_Walk, gpars=list(xlab="Length of Random Walk", ylab="Distance from origin",lty=c(1:1)))
ts.plot(Random_Walk^2, gpars=list(xlab="Length of Random Walk", ylab="MSD",lty=c(1:1)))

MSD_t=c()

for (i in 1:n) {
  MSD_t[i]=Random_Walk[i]^2/i
}

plot(seq(n)[(0.8*n):n],MSD_t[(0.8*n):n],ylim=c(-8,8))
#The coefficient can be regarded as a constant D within the fluctuation range.

#(b)
set.seed(1)
n=1000
h=0.02
t=c(0)
x=c(0)
for (i in 1:(n/h)) {
  t[i+1]=t[i]+h
  x_hat=rnorm(1,0,1/h)-x[i]
  x[i+1]=x[i]+x_hat*h
}
density(x)
plot(density(x))
#The numerical PDF is close to a normal distribution.
var(x)

```  