head(da)
x=log(da[,2:6]+1)*100
z1=x$dec5
plot(z1,type="l",col="blue",ylab="Log rate",xlab="")
plot(x$dec8,type="l",col="blue",ylab="Log rate",xlab="")
da=read.table("m-dec15678-6111.txt",header=T)
head(da)
plot(da[,2],type="l",col="blue",ylab="Log rate",xlab="")
plot(da[,2]*100,type="l",col="blue",ylab="Log rate",xlab="")
da=read.table("m-dec15678-6111.txt",header=T)
head(da)
x=log(da[,2:6]+1)*100
rtn=cbind(x$dec5,x$dec8)
plot(x$dec5,type="l",col="blue",ylab="Log rate",xlab="")
plot(x$dec8,type="l",col="blue",ylab="Log rate",xlab="")
tdx=c(1:612)/12+1961
par(mfcol=c(2,1))
tdx=c(1:612)/12+1961
par(mfcol=c(2,1))
ccm(rtn)
VMAorder(zt,lag=20)
VMAorder(rtn,lag=20) # Command for identifying MA order   Q(j,m) Statistics
####
m1=VMA(rtn,q=1)
MTSdiag(m1)
MTSdiag(m1)
m1=VMA(rtn,q=1)
MTSdiag(m1)
m2=VMAe(rtn,q=1)
MTSdiag(m2) # Model checking
m2=VMAe(rtn,q=1)
rtn=cbind(ibm,ko)
mq(rtn,10)
da=read.table("m-ibmko-0111.txt",header=T)
head(da)
x=da[,2:3]*100
x
plot(x[,1],type="l",col="blue",ylab="Log rate",xlab="")
plot(x[,2],type="l",col="blue",ylab="Log rate",xlab="")
plot(x[,2],type="l",col="blue",ylab="Log rate",xlab="")
plot(x[,2],type="l",col="blue",ylab="Log rate",xlab="")
plot(x[,1],type="l",col="blue",ylab="Log rate",xlab="")
plot(x[,1],type="l",col="blue",ylab="Log rate",xlab="")
plot(x[,2],type="l",col="blue",ylab="Log rate",xlab="")
mq(x,10)
mq(x,10)
m1=VMA(x,q=1,include.mean=F)
m2=VMAe(x,q=1,include.mean=F)
p1=matrix(c(.816,-1.116,-.623,1.074),2,2)
p2=matrix(c(-.643,.615,.592,-.133),2,2)
phi=cbind(p1,p2)
t1=matrix(c(0,-.801,-1.248,0),2,2)
Sig=matrix(c(4,2,2,5),2,2)
m1=VARMAsim(400,arlags=c(1,2),malags=c(1),phi=phi,
theta=t1,sigma=Sig)
zt=m1$series
plot(zt[,1],type="l",col="blue",ylab="Log rate",xlab="")
plot(zt[,2],type="l",col="blue",ylab="Log rate",xlab="")
p1=matrix(c(.816,-1.116,-.623,1.074),2,2)
p2=matrix(c(-.643,.615,.592,-.133),2,2)
phi=cbind(p1,p2)
t1=matrix(c(0,-.801,-1.248,0),2,2)
Sig=matrix(c(4,2,2,5),2,2)
m1=VARMAsim(400,arlags=c(1,2),malags=c(1),phi=phi,
theta=t1,sigma=Sig)
zt=m1$series
plot(zt[,1],type="l",col="blue",ylab="Log rate",xlab="")
plot(zt[,2],type="l",col="blue",ylab="Log rate",xlab="")
p1=matrix(c(.816,-1.116,-.623,1.074),2,2)
p2=matrix(c(-.643,.615,.592,-.133),2,2)
phi=cbind(p1,p2)
t1=matrix(c(0,-.801,-1.248,0),2,2)
Sig=matrix(c(4,2,2,5),2,2)
m1=VARMAsim(400,arlags=c(1,2),malags=c(1),phi=phi,
theta=t1,sigma=Sig)
zt=m1$series
plot(zt[,1],type="l",col="blue",ylab="Log rate",xlab="")
plot(zt[,2],type="l",col="blue",ylab="Log rate",xlab="")
p1=matrix(c(.816,-1.116,-.623,1.074),2,2)
p2=matrix(c(-.643,.615,.592,-.133),2,2)
phi=cbind(p1,p2)
t1=matrix(c(0,-.801,-1.248,0),2,2)
Sig=matrix(c(4,2,2,5),2,2)
m1=VARMAsim(400,arlags=c(1,2),malags=c(1),phi=phi,
theta=t1,sigma=Sig)
zt=m1$series
plot(zt[,1],type="l",col="blue",ylab="Log rate",xlab="")
plot(zt[,2],type="l",col="blue",ylab="Log rate",xlab="")
p1=matrix(c(.816,-1.116,-.623,1.074),2,2)
p2=matrix(c(-.643,.615,.592,-.133),2,2)
phi=cbind(p1,p2)
t1=matrix(c(0,-.801,-1.248,0),2,2)
Sig=matrix(c(4,2,2,5),2,2)
m1=VARMAsim(400,arlags=c(1,2),malags=c(1),phi=phi,
theta=t1,sigma=Sig)
zt=m1$series
plot(zt[,1],type="l",col="blue",ylab="Log rate",xlab="")
plot(zt[,2],type="l",col="blue",ylab="Log rate",xlab="")
m2=Eccm(zt,maxp=5,maxq=6)
p1=matrix(c(.816,-1.116,-.623,1.074),2,2)
p2=matrix(c(-.643,.615,.592,-.133),2,2)
phi=cbind(p1,p2)
t1=matrix(c(0,-.801,-1.248,0),2,2)
Sig=matrix(c(4,2,2,5),2,2)
m1=VARMAsim(400,arlags=c(1,2),phi=phi,sigma=Sig)
zt=m1$series
plot(zt[,1],type="l",col="blue",ylab="Log rate",xlab="")
plot(zt[,2],type="l",col="blue",ylab="Log rate",xlab="")
p1=matrix(c(.816,-1.116,-.623,1.074),2,2)
p2=matrix(c(-.643,.615,.592,-.133),2,2)
phi=cbind(p1,p2)
t1=matrix(c(0,-.801,-1.248,0),2,2)
Sig=matrix(c(4,2,2,5),2,2)
m1=VARMAsim(400,arlags=c(1,2),phi=phi,sigma=Sig)
zt=m1$series
plot(zt[,1],type="l",col="blue",ylab="Log rate",xlab="")
plot(zt[,2],type="l",col="blue",ylab="Log rate",xlab="")
p1=matrix(c(.816,-1.116,-.623,1.074),2,2)
p2=matrix(c(-.643,.615,.592,-.133),2,2)
phi=cbind(p1,p2)
t1=matrix(c(0,-.801,-1.248,0),2,2)
Sig=matrix(c(4,2,2,5),2,2)
m1=VARMAsim(400,arlags=c(1,2),phi=phi,sigma=Sig)
zt=m1$series
plot(zt[,1],type="l",col="blue",ylab="Log rate",xlab="")
plot(zt[,2],type="l",col="blue",ylab="Log rate",xlab="")
p1=matrix(c(.816,-1.116,-.623,1.074),2,2)
p2=matrix(c(-.643,.615,.592,-.133),2,2)
phi=cbind(p1,p2)
t1=matrix(c(0,-.801,-1.248,0),2,2)
Sig=matrix(c(4,2,2,5),2,2)
m1=VARMAsim(400,arlags=c(1,2),phi=phi,sigma=Sig)
zt=m1$series
plot(zt[,1],type="l",col="blue",ylab="Log rate",xlab="")
plot(zt[,2],type="l",col="blue",ylab="Log rate",xlab="")
p1=matrix(c(.816,-1.116,-.623,1.074),2,2)
p2=matrix(c(-.643,.615,.592,-.133),2,2)
phi=cbind(p1,p2)
t1=matrix(c(0,-.801,-1.248,0),2,2)
Sig=matrix(c(4,2,2,5),2,2)
m1=VARMAsim(400,arlags=c(1,2),phi=phi,sigma=Sig)
zt=m1$series
plot(zt[,1],type="l",col="blue",ylab="Log rate",xlab="")
plot(zt[,2],type="l",col="blue",ylab="Log rate",xlab="")
p1=matrix(c(.816,-1.116,-.623,1.074),2,2)
p2=matrix(c(-.643,.615,.592,-.133),2,2)
phi=cbind(p1,p2)
t1=matrix(c(0,-.801,-1.248,0),2,2)
Sig=matrix(c(4,2,2,5),2,2)
m1=VARMAsim(400,arlags=c(1,2),phi=phi,sigma=Sig)
zt=m1$series
plot(zt[,1],type="l",col="blue",ylab="Log rate",xlab="")
plot(zt[,2],type="l",col="blue",ylab="Log rate",xlab="")
p1=matrix(c(.816,-1.116,-.623,1.074),2,2)
p2=matrix(c(-.643,.615,.592,-.133),2,2)
phi=cbind(p1,p2)
t1=matrix(c(0,-.801,-1.248,0),2,2)
Sig=matrix(c(4,2,2,5),2,2)
m1=VARMAsim(400,arlags=c(1,2),phi=phi,sigma=Sig)
zt=m1$series
plot(zt[,1],type="l",col="blue",ylab="Log rate",xlab="")
plot(zt[,2],type="l",col="blue",ylab="Log rate",xlab="")
p1=matrix(c(.816,-1.116,-.623,1.074),2,2)
p2=matrix(c(-.643,.615,.592,-.133),2,2)
phi=cbind(p1,p2)
t1=matrix(c(0,-.801,-1.248,0),2,2)
Sig=matrix(c(4,2,2,5),2,2)
m1=VARMAsim(400,arlags=c(1,2),phi=phi,sigma=Sig)
zt=m1$series
plot(zt[,1],type="l",col="blue",ylab="Log rate",xlab="")
plot(zt[,2],type="l",col="blue",ylab="Log rate",xlab="")
p1=matrix(c(.816,-1.116,-.623,1.074),2,2)
p2=matrix(c(-.643,.615,.592,-.133),2,2)
phi=cbind(p1,p2)
t1=matrix(c(0,-.801,-1.248,0),2,2)
Sig=matrix(c(4,2,2,5),2,2)
m1=VARMAsim(400,malags=c(1,2),theta=phi,sigma=Sig)
zt=m1$series
plot(zt[,1],type="l",col="blue",ylab="Log rate",xlab="")
plot(zt[,2],type="l",col="blue",ylab="Log rate",xlab="")
p1=matrix(c(.816,-1.116,-.623,1.074),2,2)
p2=matrix(c(-.643,.615,.592,-.133),2,2)
phi=cbind(p1,p2)
t1=matrix(c(0,-.801,-1.248,0),2,2)
Sig=matrix(c(4,2,2,5),2,2)
m1=VARMAsim(400,malags=c(1,2),theta=phi,sigma=Sig)
zt=m1$series
plot(zt[,1],type="l",col="blue",ylab="Log rate",xlab="")
plot(zt[,2],type="l",col="blue",ylab="Log rate",xlab="")
A
p1=matrix(c(.816,-1.116,-.623,1.074),2,2)
p2=matrix(c(-.643,.615,.592,-.133),2,2)
phi=cbind(p1,p2)
t1=matrix(c(0,-.801,-1.248,0),2,2)
Sig=matrix(c(4,2,2,5),2,2)
m1=VARMAsim(400,malags=c(1,2),theta=phi,sigma=Sig)
zt=m1$series
plot(zt[,1],type="l",col="blue",ylab="Log rate",xlab="")
plot(zt[,2],type="l",col="blue",ylab="Log rate",xlab="")
mq(zt,10)
p1=matrix(c(.816,-1.116,-.623,1.074),2,2)
p2=matrix(c(-.643,.615,.592,-.133),2,2)
phi=cbind(p1,p2)
t1=matrix(c(0,-.801,-1.248,0),2,2)
Sig=matrix(c(4,2,2,5),2,2)
m1=VARMAsim(400,malags=c(1,2),theta=phi,sigma=Sig)
zt=m1$series
plot(zt[,1],type="l",col="blue",ylab="Log rate",xlab="")
plot(zt[,2],type="l",col="blue",ylab="Log rate",xlab="")
mq(zt,10)
p1=matrix(c(.816,-1.116,-.623,1.074),2,2)
p2=matrix(c(-.643,.615,.592,-.133),2,2)
phi=cbind(p1,p2)
t1=matrix(c(0,-.801,-1.248,0),2,2)
Sig=matrix(c(4,2,2,5),2,2)
m1=VARMAsim(400,malags=c(1),theta=t1,sigma=Sig)
zt=m1$series
plot(zt[,1],type="l",col="blue",ylab="Log rate",xlab="")
plot(zt[,2],type="l",col="blue",ylab="Log rate",xlab="")
mq(zt,10)
p1=matrix(c(.816,-1.116,-.623,1.074),2,2)
p2=matrix(c(-.643,.615,.592,-.133),2,2)
phi=cbind(p1,p2)
t1=matrix(c(0,-.801,-1.248,0),2,2)
Sig=matrix(c(4,2,2,5),2,2)
m1=VARMAsim(400,malags=c(1),theta=t1,sigma=Sig)
zt=m1$series
plot(zt[,1],type="l",col="blue",ylab="Log rate",xlab="")
plot(zt[,2],type="l",col="blue",ylab="Log rate",xlab="")
VMAorder(zt,lag=20)
p1=matrix(c(.816,-1.116,-.623,1.074),2,2)
p2=matrix(c(-.643,.615,.592,-.133),2,2)
phi=cbind(p1,p2)
t1=matrix(c(0,-.801,-1.248,0),2,2)
Sig=matrix(c(4,2,2,5),2,2)
m1=VARMAsim(400,arlags=c(1,2),malags=c(1),phi=phi,
theta=t1,sigma=Sig)
zt=m1$series
plot(zt[,1],type="l",col="blue",ylab="Log rate",xlab="")
plot(zt[,2],type="l",col="blue",ylab="Log rate",xlab="")
VMAorder(zt,lag=20)
p1=matrix(c(.816,-1.116,-.623,1.074),2,2)
p2=matrix(c(-.643,.615,.592,-.133),2,2)
phi=cbind(p1,p2)
t1=matrix(c(0,-.801,-1.248,0),2,2)
Sig=matrix(c(4,2,2,5),2,2)
m1=VARMAsim(400,malags=c(1,2),theta=phi,sigma=Sig)
zt=m1$series
plot(zt[,1],type="l",col="blue",ylab="Log rate",xlab="")
plot(zt[,2],type="l",col="blue",ylab="Log rate",xlab="")
VMAorder(zt,lag=20)
p1=matrix(c(.816,-1.116,-.623,1.074),2,2)
p2=matrix(c(-.643,.615,.592,-.133),2,2)
phi=cbind(p1,p2)
t1=matrix(c(0,-.801,-1.248,0),2,2)
Sig=matrix(c(4,2,2,5),2,2)
m1=VARMAsim(400,malags=c(1,2),theta=t1,sigma=Sig)
zt=m1$series
plot(zt[,1],type="l",col="blue",ylab="Log rate",xlab="")
plot(zt[,2],type="l",col="blue",ylab="Log rate",xlab="")
VMAorder(zt,lag=20)
p1=matrix(c(.816,-1.116,-.623,1.074),2,2)
p2=matrix(c(-.643,.615,.592,-.133),2,2)
phi=cbind(p1,p2)
t1=matrix(c(0,-.801,-1.248,0),2,2)
Sig=matrix(c(4,2,2,5),2,2)
m1=VARMAsim(400,malags=c(1),theta=t1,sigma=Sig)
zt=m1$series
plot(zt[,1],type="l",col="blue",ylab="Log rate",xlab="")
plot(zt[,2],type="l",col="blue",ylab="Log rate",xlab="")
VMAorder(zt,lag=20)
p1=matrix(c(.816,-1.116,-.623,1.074),2,2)
p2=matrix(c(-.643,.615,.592,-.133),2,2)
phi=cbind(p1,p2)
t1=matrix(c(0,-.801,-1.248,0),2,2)
Sig=matrix(c(4,2,2,5),2,2)
m1=VARMAsim(400,arlags=c(1,2),phi=phi,sigma=Sig)
zt=m1$series
plot(zt[,1],type="l",col="blue",ylab="Log rate",xlab="")
plot(zt[,2],type="l",col="blue",ylab="Log rate",xlab="")
p1=matrix(c(.816,-1.116,-.623,1.074),2,2)
p2=matrix(c(-.643,.615,.592,-.133),2,2)
phi=cbind(p1,p2)
t1=matrix(c(0,-.801,-1.248,0),2,2)
Sig=matrix(c(4,2,2,5),2,2)
m1=VARMAsim(400,arlags=c(1,2),phi=phi,sigma=Sig)
zt=m1$series
plot(zt[,1],type="l",col="blue",ylab="Log rate",xlab="")
plot(zt[,2],type="l",col="blue",ylab="Log rate",xlab="")
p1=matrix(c(.816,-1.116,-.623,1.074),2,2)
p2=matrix(c(-.643,.615,.592,-.133),2,2)
phi=cbind(p1,p2)
t1=matrix(c(0,-.801,-1.248,0),2,2)
Sig=matrix(c(4,2,2,5),2,2)
m1=VARMAsim(400,arlags=c(1,2),phi=phi,sigma=Sig)
zt=m1$series
plot(zt[,1],type="l",col="blue",ylab="Log rate",xlab="")
plot(zt[,2],type="l",col="blue",ylab="Log rate",xlab="")
mq(z,lag=10) # Compute Q(m) statistics
ccm(z, lag=4)
summary(fit0)
fit=VARselect(z, lag.max=10,type="const")
fit
pre=predict(fit0,n.ahead=6,ci=0.95)
pre
serial.test(fit0, lags.pt =10, type = "PT.adjusted")
fit0=VAR(z, lag.max=2,type="const",ic="AIC")
summary(fit0)
library(vars)
fit0=VAR(z, lag.max=2,type="const",ic="AIC")
summary(fit0)
fit0=VAR(z, lag.max=2,type="const",ic="AIC")
summary(fit0)
detach("package:MTS", unload = TRUE)
fit0=VAR(z, lag.max=2,type="const",ic="AIC")
summary(fit0)
fit0=VAR(z, lag.max=2,type="const",ic="AIC")
summary(fit0)
p1=matrix(c(.816,-1.116,-.623,1.074),2,2)
p2=matrix(c(-.643,.615,.592,-.133),2,2)
phi=cbind(p1,p2)
t1=matrix(c(0,-.801,-1.248,0),2,2)
Sig=matrix(c(4,2,2,5),2,2)
m1=VARMAsim(400,arlags=c(1,2),phi=phi,sigma=Sig)
zt=m1$series
plot(zt[,1],type="l",col="blue",ylab="Log rate",xlab="")
plot(zt[,2],type="l",col="blue",ylab="Log rate",xlab="")
ccm(z, lag=4)
mq(z,lag=10) # Compute Q(m) statistics
fit0=VAR(z, lag.max=2,type="const",ic="AIC")
summary(fit0)
p1=matrix(c(.816,-1.116,-.623,1.074),2,2)
p2=matrix(c(-.643,.615,.592,-.133),2,2)
phi=cbind(p1,p2)
t1=matrix(c(0,-.801,-1.248,0),2,2)
Sig=matrix(c(4,2,2,5),2,2)
m1=VARMAsim(400,arlags=c(1,2),phi=phi,sigma=Sig)
zt=m1$series
plot(zt[,1],type="l",col="blue",ylab="Log rate",xlab="")
plot(zt[,2],type="l",col="blue",ylab="Log rate",xlab="")
ccm(z, lag=4)
mq(z,lag=10) # Compute Q(m) statistics
fit0=VAR(z, lag.max=2,type="const",ic="AIC")
summary(fit0)
library(MTS)
p1=matrix(c(.816,-1.116,-.623,1.074),2,2)
p2=matrix(c(-.643,.615,.592,-.133),2,2)
phi=cbind(p1,p2)
t1=matrix(c(0,-.801,-1.248,0),2,2)
Sig=matrix(c(4,2,2,5),2,2)
m1=VARMAsim(400,arlags=c(1,2),phi=phi,sigma=Sig)
zt=m1$series
plot(zt[,1],type="l",col="blue",ylab="Log rate",xlab="")
plot(zt[,2],type="l",col="blue",ylab="Log rate",xlab="")
ccm(z, lag=4)
mq(z,lag=10) # Compute Q(m) statistics
fit0=VAR(z, lag.max=2,type="const",ic="AIC")
summary(fit0)
p1=matrix(c(.816,-1.116,-.623,1.074),2,2)
p2=matrix(c(-.643,.615,.592,-.133),2,2)
phi=cbind(p1,p2)
t1=matrix(c(0,-.801,-1.248,0),2,2)
Sig=matrix(c(4,2,2,5),2,2)
m1=VARMAsim(400,arlags=c(1,2),phi=phi,sigma=Sig)
zt=m1$series
plot(zt[,1],type="l",col="blue",ylab="Log rate",xlab="")
plot(zt[,2],type="l",col="blue",ylab="Log rate",xlab="")
ccm(z, lag=4)
mq(z,lag=10) # Compute Q(m) statistics
fit0=VAR(z, lag.max=2,type="const",ic="AIC")
summary(fit0)
detach("package:vars", unload = TRUE)
p1=matrix(c(.816,-1.116,-.623,1.074),2,2)
p2=matrix(c(-.643,.615,.592,-.133),2,2)
phi=cbind(p1,p2)
t1=matrix(c(0,-.801,-1.248,0),2,2)
Sig=matrix(c(4,2,2,5),2,2)
m1=VARMAsim(400,arlags=c(1,2),phi=phi,sigma=Sig)
zt=m1$series
plot(zt[,1],type="l",col="blue",ylab="Log rate",xlab="")
plot(zt[,2],type="l",col="blue",ylab="Log rate",xlab="")
ccm(z, lag=4)
mq(z,lag=10) # Compute Q(m) statistics
fit0=VAR(z, lag.max=2,type="const",ic="AIC")
summary(fit0)
p1=matrix(c(.816,-1.116,-.623,1.074),2,2)
p2=matrix(c(-.643,.615,.592,-.133),2,2)
phi=cbind(p1,p2)
t1=matrix(c(0,-.801,-1.248,0),2,2)
Sig=matrix(c(4,2,2,5),2,2)
m1=VARMAsim(400,arlags=c(1,2),phi=phi,sigma=Sig)
zt=m1$series
plot(zt[,1],type="l",col="blue",ylab="Log rate",xlab="")
plot(zt[,2],type="l",col="blue",ylab="Log rate",xlab="")
ccm(z, lag=4)
mq(z,lag=10) # Compute Q(m) statistics
fit0=VAR(z, lag.max=2,type="const",ic="AIC")
summary(fit0)
p1=matrix(c(.816,-1.116,-.623,1.074),2,2)
p2=matrix(c(-.643,.615,.592,-.133),2,2)
phi=cbind(p1,p2)
t1=matrix(c(0,-.801,-1.248,0),2,2)
Sig=matrix(c(4,2,2,5),2,2)
m1=VARMAsim(400,arlags=c(1,2),phi=phi,sigma=Sig)
zt=m1$series
plot(zt[,1],type="l",col="blue",ylab="Log rate",xlab="")
plot(zt[,2],type="l",col="blue",ylab="Log rate",xlab="")
ccm(zt, lag=4)
mq(zt,lag=10) # Compute Q(m) statistics
fit0=VAR(zt, lag.max=2,type="const",ic="AIC")
summary(fit0)
fit=VARselect(z, lag.max=10,type="const")
fit
fit0=VAR(zt, lag.max=2,type="const",ic="AIC")
summary(fit0)
fit0=VAR(zt, lag.max=2,type="const",ic="AIC")
summary(fit0)
fit=VARselect(zt, lag.max=10,type="const")
fit
library(vars)
fit0=VAR(zt, lag.max=2,type="const",ic="AIC")
summary(fit0)
fit0=VAR(zt, lag.max=3,type="const",ic="AIC")
summary(fit0)
fit0=VAR(zt, lag.max=3,type="const",ic="AIC")
summary(fit0)
fit=VARselect(zt, lag.max=10,type="const")
fit
fit0=VAR(zt, lag.max=2,type="const",ic="AIC")
summary(fit0)
serial.test(fit0, lags.pt =10, type = "PT.adjusted")
p1=matrix(c(.816,-1.116,-.623,1.074),2,2)
p2=matrix(c(-.643,.615,.592,-.133),2,2)
phi=cbind(p1,p2)
t1=matrix(c(0,-.801,-1.248,0),2,2)
Sig=matrix(c(4,2,2,5),2,2)
m1=VARMAsim(400,malags=c(1),theta=t1,sigma=Sig)
zt=m1$series
plot(zt[,1],type="l",col="blue",ylab="Log rate",xlab="")
plot(zt[,2],type="l",col="blue",ylab="Log rate",xlab="")
VMAorder(zt,lag=20)
m1=VMA(zt,q=2,include.mean=F)
p1=matrix(c(.816,-1.116,-.623,1.074),2,2)
p2=matrix(c(-.643,.615,.592,-.133),2,2)
phi=cbind(p1,p2)
t1=matrix(c(0,-.801,-1.248,0),2,2)
Sig=matrix(c(4,2,2,5),2,2)
m1=VARMAsim(400,malags=c(1,2),theta=phi,sigma=Sig)
zt=m1$series
plot(zt[,1],type="l",col="blue",ylab="Log rate",xlab="")
plot(zt[,2],type="l",col="blue",ylab="Log rate",xlab="")
VMAorder(zt,lag=20)
p1=matrix(c(.816,-1.116,-.623,1.074),2,2)
p2=matrix(c(-.643,.615,.592,-.133),2,2)
phi=cbind(p1,p2)
t1=matrix(c(0,-.801,-1.248,0),2,2)
Sig=matrix(c(4,2,2,5),2,2)
m1=VARMAsim(400,malags=c(1,2),theta=phi,sigma=Sig)
zt=m1$series
plot(zt[,1],type="l",col="blue",ylab="Log rate",xlab="")
plot(zt[,2],type="l",col="blue",ylab="Log rate",xlab="")
VMAorder(zt,lag=20)
m1=VMA(zt,q=2,include.mean=F)
#generate II N(0, I_2) rm.
sig=diag(2) # create the 2-by-2 identity matrix
xt=rmvnorm(300,rep(0,2),sig) # generate random draws
MTSplot(xt) # Obtain time series plots (output not shown)
ccm(xt, lag=4)
mq(xt,10)
sig=diag(3) # Simulation study
z=rmvnorm(200,rep(0,3),sig)
mq(z,10)
###############################################
phi1=matrix(c(.2,-.6,.3,1.1),2,2) # Input phi_1
phi1
sig=matrix(c(1,0.8,0.8,2),2,2) # Input sigma_a
sig
m1=eigen(phi1) # Obtain eigenvalues & vectors
m1$values
m1$vectors
I4=diag(4) ## Create the 4-by-4 identity matrix
pp=kronecker(phi1,phi1) # Kronecker product
pp
c1=c(sig)
c1
dd=I4-pp
ddinv=solve(dd) ## Obtain inverse
gam0=ddinv%*%matrix(c1,4,1) # Obtain Gamma_0
gam0
g0=matrix(gam0,2,2)
g1=phi1%*%g0 ## Obtain Gamma_1
g1
g2=phi1%*%g1
g2
D=diag(sqrt(diag(g0))) # To compute cross-correlation  matrices
D
Di=solve(D)
Di%*%g0%*%Di
Di%*%g1%*%Di
Di%*%g2%*%Di
################################################################################
m1 <- VARMAsim(400,arlags=c(1),phi=phi1,sigma=sig)
x = m1$series[,1]
y = m1$series[,2]
plot(x,type="l" )
plot(y,type="l")
z=cbind(x,y) # Create a vector series
summary(z)
ccm(z, lag=4)
mq(z,lag=10) # Compute Q(m) statistics
fit0=VAR(z, lag.max=1,type="const",ic="AIC")
summary(fit0)
