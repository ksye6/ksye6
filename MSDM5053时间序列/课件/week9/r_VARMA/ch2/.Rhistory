plot(zt[,1],type="l",col="blue",ylab="Log rate",xlab="")
plot(zt[,2],type="l",col="red",ylab="Log rate",xlab="")
VMAorder(zt,lag=20)
m1=VMA(zt,q=1,include.mean=F)
MTSdiag(m1) # Model checking
# Simulating MA  model
p1=matrix(c(.816,-1.116,-.623,1.074),2,2)
p2=matrix(c(-.643,.615,.592,-.133),2,2)
phi=cbind(p1,p2)
t1=matrix(c(0,-.801,-1.248,0),2,2)
Sig=matrix(c(4,2,2,5),2,2)
m1=VARMAsim(400,malags=c(1),theta=p2,sigma=Sig)
zt=m1$series
plot(zt[,1],type="l",col="blue",ylab="Log rate",xlab="")
plot(zt[,2],type="l",col="red",ylab="Log rate",xlab="")
VMAorder(zt,lag=20)
m1=VMA(zt,q=1,include.mean=F)
MTSdiag(m1) # Model checking
# Simulating MA  model
p1=matrix(c(.816,-1.116,-.623,1.074),2,2)
p2=matrix(c(-.643,.615,.592,-.133),2,2)
phi=cbind(p1,p2)
t1=matrix(c(0,-.801,-1.248,0),2,2)
Sig=matrix(c(4,2,2,5),2,2)
m1=VARMAsim(400,malags=c(1),theta=p2,sigma=Sig)
zt=m1$series
plot(zt[,1],type="l",col="blue",ylab="Log rate",xlab="")
plot(zt[,2],type="l",col="red",ylab="Log rate",xlab="")
VMAorder(zt,lag=20)
m1=VMA(zt,q=1,include.mean=F)
MTSdiag(m1) # Model checking
# Simulating MA  model
p1=matrix(c(.816,-1.116,-.623,1.074),2,2)
p2=matrix(c(-.643,.615,.592,-.133),2,2)
phi=cbind(p1,p2)
t1=matrix(c(0,-.801,-1.248,0),2,2)
Sig=matrix(c(4,2,2,5),2,2)
m1=VARMAsim(400,malags=c(1),theta=p2,sigma=Sig)
zt=m1$series
plot(zt[,1],type="l",col="blue",ylab="Log rate",xlab="")
plot(zt[,2],type="l",col="red",ylab="Log rate",xlab="")
VMAorder(zt,lag=20)
m1=VMA(zt,q=1,include.mean=F)
m2=VMAe(zt,q=1)
p1=matrix(c(.816,-1.116,-.623,1.074),2,2)
p2=matrix(c(-.643,.615,.592,-.133),2,2)
phi=cbind(p1,p2)
t1=matrix(c(0,-.801,-1.248,0),2,2)
Sig=matrix(c(4,2,2,5),2,2)
m1=VARMAsim(400,arlags=c(1,2),malags=c(1),phi=phi,
theta=t1,sigma=Sig)
zt=m1$series
plot(zt[,1],type="l",col="blue",ylab="Log rate",xlab="")
plot(zt[,2],type="l",col="blue",ylab="Log rate",xlab="")
p1=matrix(c(.816,-1.116,-.623,1.074),2,2)
p2=matrix(c(-.643,.615,.592,-.133),2,2)
phi=cbind(p1,p2)
t1=matrix(c(0,-.801,-1.248,0),2,2)
Sig=matrix(c(4,2,2,5),2,2)
m1=VARMAsim(400,arlags=c(1,2),malags=c(1),phi=phi,
theta=t1,sigma=Sig)
zt=m1$series
plot(zt[,1],type="l",col="blue",ylab="Log rate",xlab="")
plot(zt[,2],type="l",col="blue",ylab="Log rate",xlab="")
p1=matrix(c(.816,-1.116,-.623,1.074),2,2)
p2=matrix(c(-.643,.615,.592,-.133),2,2)
phi=cbind(p1,p2)
t1=matrix(c(0,-.801,-1.248,0),2,2)
Sig=matrix(c(4,2,2,5),2,2)
m1=VARMAsim(400,arlags=c(1,2),malags=c(1),phi=phi,
theta=t1,sigma=Sig)
zt=m1$series
plot(zt[,1],type="l",col="blue",ylab="Log rate",xlab="")
plot(zt[,2],type="l",col="blue",ylab="Log rate",xlab="")
p1=matrix(c(.816,-1.116,-.623,1.074),2,2)
p2=matrix(c(-.643,.615,.592,-.133),2,2)
phi=cbind(p1,p2)
t1=matrix(c(0,-.801,-1.248,0),2,2)
Sig=matrix(c(4,2,2,5),2,2)
m1=VARMAsim(400,arlags=c(1,2),malags=c(1),phi=phi,
theta=t1,sigma=Sig)
zt=m1$series
plot(zt[,1],type="l",col="blue",ylab="Log rate",xlab="")
plot(zt[,2],type="l",col="blue",ylab="Log rate",xlab="")
m2=Eccm(zt,maxp=5,maxq=6)
p1=matrix(c(.816,-1.116,-.623,1.074),2,2)
p2=matrix(c(-.643,.615,.592,-.133),2,2)
phi=cbind(p1,p2)
t1=matrix(c(0,-.801,-1.248,0),2,2)
Sig=matrix(c(4,2,2,5),2,2)
m1=VARMAsim(400,arlags=c(1,2),malags=c(1),phi=phi,
theta=t1,sigma=Sig)
zt=m1$series
plot(zt[,1],type="l",col="blue",ylab="Log rate",xlab="")
plot(zt[,2],type="l",col="blue",ylab="Log rate",xlab="")
m2=Eccm(zt,maxp=5,maxq=6)
m2=VARMA(zt,p=2,q=2) ## fit a VARMA(2,1) model
MTSdiag(m2) # Model checking
p1=matrix(c(.816,-1.116,-.623,1.074),2,2)
p2=matrix(c(-.643,.615,.592,-.133),2,2)
phi=cbind(p1,p2)
t1=matrix(c(0,-.801,-1.248,0),2,2)
Sig=matrix(c(4,2,2,5),2,2)
m1=VARMAsim(1000,arlags=c(1,2),malags=c(1),phi=phi,
theta=t1,sigma=Sig)
zt=m1$series
plot(zt[,1],type="l",col="blue",ylab="Log rate",xlab="")
plot(zt[,2],type="l",col="blue",ylab="Log rate",xlab="")
m2=Eccm(zt,maxp=5,maxq=6)
m2=VARMA(zt,p=2,q=1) ## fit a VARMA(2,1) model
MTSdiag(m2) # Model checking
## remove (almost) everything in the working environment.
setwd("C:/ling/teaching/Shanxi-2021/r_VARMA/ch3")  #set my working directory
#Purpose: build a simple VAR model for the monthly log returns of  IBM
da1=read.table("m-pce.txt",header=T)
da2=read.table("m-dspi.txt",header=T)
plot(da1[,4],type="l",col="blue",ylab="Log rate",xlab="")
plot(da2[,4],type="l",col="blue",ylab="Log rate",xlab="")
z1=diff(log(da1[,4]))
z2=diff(log(da2[,4]))
plot(z1,type="l",col="blue",ylab="Log rate",xlab="")
plot(z2,type="l",col="blue",ylab="Log rate",xlab="")
zt=cbind(z1,z2)*100
colnames(zt) <- c("pceg","dspig")
VARorder(zt)
m1=VAR(zt,3) ## fit a VAR(3) model
m1a=refVAR(m1,thres=1) ## refine the VAR(3) model
MTSdiag(m1a) ## model checking
m1=VAR(zt,8) ## fit a VAR(3) model
m1a=refVAR(m1,thres=1) ## refine
MTSdiag(m1a) ## model checking
Eccm(zt,maxp=6,maxq=6)
m2=VARMA(zt,p=3,q=1) ## fit a VARMA(3,1) model
m2a=refVARMA(m2,thres=0.8) # refine the fit
m2b=refVARMA(m2a,thres=1) # refine further the fit.
m2b=refVARMA(m2a,thres=1) # refine further the fit.
MTSdiag(m2b)
m1=VAR(zt,8) ## fit a VAR(3) model
m1a=refVAR(m1,thres=1) ## refine the VAR(3) model
VARMApred(m2b,8)
###Example 8.4(page 407)
rm(list = ls())
## remove (almost) everything in the working environment.
setwd("C:/ling/teaching/Shanxi-2021/r_VARMA")  #set my working directory
#Purpose: build a simple VAR model for the monthly log returns of  IBM
da=read.table("q-rgdp-brkris.txt",header=T)
head(da)
x=log(da[,3:5]+1)*100
rtn=cbind(x$Brazil,X$Korea,X$ Israel)
plot(x$Brazil,type="l",col="blue",ylab="Log rate",xlab="")
plot(x$Korea,type="l",col="red",ylab="Log rate",xlab="")
###Example 8.4(page 407)
rm(list = ls())
## remove (almost) everything in the working environment.
setwd("C:/ling/teaching/Shanxi-2021/r_VARMA")  #set my working directory
#Purpose: build a simple VAR model for the monthly log returns of  IBM
da=read.table("q-rgdp-brkris.txt",header=T)
head(da)
x=log(da[,3:5]+1)*100
rtn=cbind(x$Brazil, X$Korea, X$Israel)
###Example 8.4(page 407)
rm(list = ls())
## remove (almost) everything in the working environment.
setwd("C:/ling/teaching/Shanxi-2021/r_VARMA/ch2")  #set my working directory
#Purpose: build a simple VAR model for the monthly log returns of  IBM
da=read.table("q-rgdp-brkris.txt",header=T)
head(da)
x=log(da[,3:5]+1)*100
rtn=cbind(x$Brazil, X$Korea, X$Israel)
plot(x$Brazil,type="l",col="blue",ylab="Log rate",xlab="")
plot(x$Korea,type="l",col="red",ylab="Log rate",xlab="")
plot(x$Brazil,type="l",col="blue",ylab="Log rate",xlab="")
plot(x$Korea,type="l",col="red",ylab="Log rate",xlab="")
plot(x$Israel,type="l",col="red",ylab="Log rate",xlab="")
x=log(da[,3:5]+1)
rtn=cbind(x$Brazil, X$Korea, X$Israel)
plot(x$Brazil,type="l",col="blue",ylab="Log rate",xlab="")
plot(x$Korea,type="l",col="red",ylab="Log rate",xlab="")
plot(x$Israel,type="l",col="red",ylab="Log rate",xlab="")
###Example 8.4(page 407)
rm(list = ls())
## remove (almost) everything in the working environment.
setwd("C:/ling/teaching/Shanxi-2021/r_VARMA/ch2")  #set my working directory
#Purpose: build a simple VAR model for the monthly log returns of  IBM
da=read.table("q-rgdp-brkris.txt",header=T)
head(da)
x=log(da[,3:5]/100+1)*100
rtn=cbind(x$Brazil, X$Korea, X$Israel)
plot(x$Brazil,type="l",col="blue",ylab="Log rate",xlab="")
plot(x$Korea,type="l",col="red",ylab="Log rate",xlab="")
plot(x$Israel,type="l",col="red",ylab="Log rate",xlab="")
###Example 8.4(page 407)
rm(list = ls())
## remove (almost) everything in the working environment.
setwd("C:/ling/teaching/Shanxi-2021/r_VARMA/ch2")  #set my working directory
#Purpose: build a simple VAR model for the monthly log returns of  IBM
da=read.table("q-rgdp-brkris.txt",header=T)
head(da)
x=log(da[,3:5]+1)
rtn=cbind(x$Brazil, X$Korea, X$Israel)
plot(x$Brazil,type="l",col="blue",ylab="Log rate",xlab="")
plot(x$Korea,type="l",col="red",ylab="Log rate",xlab="")
plot(x$Israel,type="l",col="red",ylab="Log rate",xlab="")
###Example 8.4(page 407)
rm(list = ls())
## remove (almost) everything in the working environment.
setwd("C:/ling/teaching/Shanxi-2021/r_VARMA/ch2")  #set my working directory
#Purpose: build a simple VAR model for the monthly log returns of  IBM
da=read.table("q-rgdp-brkris.txt",header=T)
head(da)
x=log(da[,3:5]/100+1)*100
rtn=cbind(x$Brazil, X$Korea, X$Israel)
plot(x$Brazil,type="l",col="blue",ylab="Log rate",xlab="")
plot(x$Korea,type="l",col="red",ylab="Log rate",xlab="")
plot(x$Israel,type="l",col="red",ylab="Log rate",xlab="")
ccm(x, lag=10)
mq(x,10)
names(m2)
m2=VARorder(z)
library(vars)
names(m2)
m2=VARorder(z)
names(m2)
m2=VARorder(x)
m2=VAR(x,1)
m2=VAR(x,1)
m2
resi=m2$residuals
mq(resi,adj=9)   # plot not shown
m2=VAR(x,1)
m2
resi=m2$residuals
mq(resi,adj=9)   # plot not shown
mq(m2$residuals,adj=9)   # plot not shown
m2=VAR(x,1)
m2
resi=m2$residuals
mq(m2$residuals,adj=9)   # plot not shown
m2=VAR(x,p=1)
m2
resi=m2$residuals
mq(m2$residuals,adj=9)   # plot not shown
names(m2)
m2=VAR(x,p=1)
m2
resi=m2$residuals
mq(m2$residuals,adj=9)   # plot not shown
resi=m2$residuals
mq(resi,adj=9)   # plot not shown
resi=m2$residuals
mq(resi, adj=9)   # plot not shown
###Example 8.4(page 407)
rm(list = ls())
## remove (almost) everything in the working environment.
setwd("C:/ling/teaching/Shanxi-2021/r_VARMA/ch2")  #set my working directory
#Purpose: build a simple VAR model for the monthly log returns of  IBM
#require(MTS)  ### Load package
da=read.table("q-gdp-ukcaus.txt",header=T)
gdp=log(da[,3:5])
plot(gdp[,1],type="l",col="blue",ylab="Log rate",xlab="")
plot(gdp[,2],type="l",col="blue",ylab="Log rate",xlab="")
plot(gdp[,3],type="l",col="blue",ylab="Log rate",xlab="")
dim(gdp)
#[1] 126   3
z=gdp[2:126,]-gdp[1:125,]
z=z*100
dim(z)
plot(z[,1],type="l",col="blue",ylab="Log rate",xlab="")
plot(z[,2],type="l",col="blue",ylab="Log rate",xlab="")
plot(z[,3],type="l",col="blue",ylab="Log rate",xlab="")
ccm(z, lag=10)
mq(z,10)
m1=VAR(z,2)
m1
### VAR order specification
names(m2)
m2=VARorder(z)
### Recall VAR estimation
m1=VAR(z,2)
#    names(m1)
resi=m1$residuals
mq(resi,adj=18)   # plot not shown
## Recall VAR estimation
m1=VAR(z,2)
#    names(m1)
resi=m1$residuals
mq(resi,adj=18)   # plot not shown
detach("package:vars", unload = TRUE)
## Recall VAR estimation
m1=VAR(z,2)
#    names(m1)
resi=m1$residuals
mq(resi,adj=18)   # plot not shown
m2=VAR(x,p=1)
m2
resi=m2$residuals
mq(resi, adj=9)   # plot not shown
m2=VAR(x,p=1)
m2
resi=m2$residuals
mq(resi, adj=9)   # plot not shown
m2=VAR(x,1)
m2
resi=m2$residuals
mq(resi, adj=9)   # plot not shown
m2=VAR(x,1)
m2
resi=m2$residuals
mq(resi, adj=9)   # plot not shown
ccm(rtn, lag=10)
mq(rtn,10)
# compute percentage log returns.
x=log(da[,3:5]/100+1)*100
rtn=cbind(x$Brazil, x$Korea, x$Israel)
# compute percentage log returns.
x=log(da[,3:5]/100+1)*100
rtn=cbind(x$Brazil, x$Korea, x$Israel)
plot(x$Brazil,type="l",col="blue",ylab="Log rate",xlab="")
plot(x$Korea,type="l",col="red",ylab="Log rate",xlab="")
plot(x$Israel,type="l",col="red",ylab="Log rate",xlab="")
ccm(rtn, lag=10)
mq(rtn,10)
library(vars)
# compute percentage log returns.
x=log(da[,3:5]/100+1)*100
rtn=cbind(x$Brazil, x$Korea, x$Israel)
plot(x$Brazil,type="l",col="blue",ylab="Log rate",xlab="")
plot(x$Korea,type="l",col="red",ylab="Log rate",xlab="")
plot(x$Israel,type="l",col="red",ylab="Log rate",xlab="")
ccm(rtn, lag=10)
mq(rtn,10)
x
setwd("C:/ling/teaching/Shanxi-2021/r_VARMA/ch2")  #set my working directory
#Purpose: build a simple VAR model for the monthly log returns of  IBM
da=read.table("q-rgdp-brkris.txt",header=T)
head(da)
# compute percentage log returns.
x=log(da[,3:5]/100+1)*100
rtn=cbind(x$Brazil, x$Korea, x$Israel)
x
x=log(da[,3:5]/100+1)*100
rtn=cbind(x$Brazil, x$Korea, x$Israel)
rtn
plot(x$Brazil,type="l",col="blue",ylab="Log rate",xlab="")
plot(x$Korea,type="l",col="red",ylab="Log rate",xlab="")
plot(x$Israel,type="l",col="red",ylab="Log rate",xlab="")
ccm(rtn, lag=10)
plot(x$Korea,type="l",col="red",ylab="Log rate",xlab="")
plot(x$Israel,type="l",col="red",ylab="Log rate",xlab="")
ccm(rtn, lag=10)
mq(rtn,10)
names(m1)
m1=VARorder(rtn)
m2=VAR(rtn,1)
m2
m2=VAR(rtn,1)
m2
resi=m2$residuals
mq(resi, adj=9)   # plot not shown
resi=m2$residuals
resi
detach("package:vars", unload = TRUE)
resi=m2$residuals
mq(resi, adj=9)   # plot not shown
m1=VARorder(rtn)
m1=VARorder(rtn)
#names(m2)
m2=VAR(rtn,1)
m2
m1=VARorder(rtn)
#names(m2)
m2=VAR(rtn,1)
m2
resi=m2$residuals
mq(resi, adj=9)   # plot not shown
mq(resi, adj=9)   # plot not shown
m3=VARchi(rtn,p=1)  #   Number of targeted parameters:   Chi-square test and p-value:  15.16379 0.05603778
m3=VARchi(rtn,p=1,thres=1.96)   #  Number of targeted parameters: 10  Chi-square test and p-value:  31.68739 0.000451394
m1=VAR(rtn,1) # fit a un-constrained VAR(2) model.
m2=refVAR(m1,thres=1.96) # Model refinement.
resi=m2$residuals
mq(resi,adj=6)   # plot not shown
MTSdiag(m2,adj=6)
VARpred(m2,8)  ## Using unconstrained model
## Impulse response functions
## Using the simplified model
Phi=m2$Phi
Sig=m2$Sigma
VARirf(Phi,Sig)  #   Press return to continue  ## Plots not shownSee Figures 2.8 and 2.9 of the book
## remove (almost) everything in the working environment.
setwd("C:/ling/teaching/Shanxi-2021/r_VARMA/ch2")  #set my working directory
#Purpose: build a simple VAR model for the monthly log returns of  IBM
da=read.table("q-rgdp-brkris.txt",header=T)
head(da)
# compute percentage log returns.
x=log(da[,3:5]/100+1)*100
plot(x$Brazil,type="l",col="blue",ylab="Log rate",xlab="")
plot(x$Korea,type="l",col="red",ylab="Log rate",xlab="")
plot(x$Israel,type="l",col="red",ylab="Log rate",xlab="")
rm(list = ls())
## remove (almost) everything in the working environment.
setwd("C:/ling/teaching/Shanxi-2021/r_VARMA/ch2")  #set my working directory
#Purpose: build a simple VAR model for the monthly log returns of  IBM
da=read.table("q-rgdp-brkris.txt",header=T)
head(da)
# compute percentage log returns.
x=log(da[,3:5]/100+1)*100
plot(x$Brazil,type="l",col="blue",ylab="Log rate",xlab="")
plot(x$Korea,type="l",col="red",ylab="Log rate",xlab="")
plot(x$Israel,type="l",col="red",ylab="Log rate",xlab="")
plot(x$Brazil,type="l",col="blue",ylab="Log rate",xlab="")
plot(x$Korea,type="l",col="black",ylab="Log rate",xlab="")
plot(x$Israel,type="l",col="red",ylab="Log rate",xlab="")
plot(x$Brazil,type="l",col="blue",ylab="Log rate",xlab="")
plot(x$Korea,type="l",col="black",ylab="Log rate",xlab="")
plot(x$Israel,type="l",col="red",ylab="Log rate",xlab="")
rtn=cbind(x$Brazil, x$Korea, x$Israel)
rtn
ccm(rtn, lag=10)
mq(rtn,10)
ccm(rtn, lag=10)
mq(rtn,10)
m1=VARorder(rtn)
ccm(rtn, lag=10)
mq(rtn,10)
m1=VARorder(rtn)
m2=VAR(rtn,1)
ccm(rtn, lag=10)
mq(rtn,10)
m1=VARorder(rtn)
m2=VAR(rtn,1)
resi=m2$residuals
ccm(rtn, lag=10)
mq(rtn,10)
m1=VARorder(rtn)
m2=VAR(rtn,1)
resi=m2$residuals
mq(resi, adj=9)   # plot not shown
m3=VARchi(rtn,p=1,thres=1.96)   #  Number of targeted parameters: 6
m3=VARchi(rtn,p=1,thres=1.96)   #  Number of targeted parameters: 6
m1=VAR(rtn,1) # fit a un-constrained VAR(1) model.
m2=refVAR(m1,thres=1.96) # Model refinement.
m3=VARchi(rtn,p=1,thres=1.96)   #  Number of targeted parameters: 6
m1=VAR(rtn,1) # fit a un-constrained VAR(1) model.
m2=refVAR(m1,thres=1.96) # Model refinement.
resi=m2$residuals
mq(resi,adj=6)   # plot not shown
resi=m2$residuals
### Model checking
mq(resi,adj=6)   #
resi=m2$residuals
### Model checking
mq(resi,adj=6)   #
MTSdiag(m2,adj=6)
VARpred(m2,8)  ## Using unconstrained model
Phi=m2$Phi
Sig=m2$Sigma
VARirf(Phi,Sig)  #   Press return to continue  ## Plots not shownSee Figures 2.8 and 2.9 of the book
Phi=m2$Phi
Sig=m2$Sigma
VARirf(Phi,Sig)  #   Press return to continue  ## Plots not shownSee Figures 2.8 and 2.9 of the book
Phi=m2$Phi
Sig=m2$Sigma
VARirf(Phi,Sig)  #   Press return to continue
Phi=m2$Phi
Sig=m2$Sigma
VARirf(Phi,Sig)  #   Press return to continue
Phi=m2$Phi
Sig=m2$Sigma
VARirf(Phi,Sig)  #   Press return to continue
Phi=m2$Phi
Sig=m2$Sigma
VARirf(Phi,Sig)  #   Press return to continue
Sig=m2$Sigma
VARirf(Phi,Sig)  #   Press return to continue
VARirf(Phi,Sig,orth=F)
VARirf(Phi,Sig,orth=F)
VARirf(Phi,Sig,orth=F)
VARirf(Phi,Sig,orth=F)
VARirf(Phi,Sig,orth=F) #      Press return to continue  ## Plots not shown
rm(list = ls())
## remove (almost) everything in the working environment.
setwd("C:/ling/teaching/Shanxi-2021/r_VARMA/ch2")  #set my working directory
#Purpose: build a simple VAR model for the monthly log returns of  IBM
da=read.table("q-rgdp-brkris.txt",header=T)
head(da)
# compute percentage log returns.
x=log(da[,3:5]/100+1)*100
plot(x$Brazil,type="l",col="blue",ylab="Log rate",xlab="")
plot(x$Korea,type="l",col="black",ylab="Log rate",xlab="")
plot(x$Israel,type="l",col="red",ylab="Log rate",xlab="")
rtn=cbind(x$Brazil, x$Korea, x$Israel)
rtn
ccm(rtn, lag=10)
mq(rtn,10)
m1=VARorder(rtn)
m2=VAR(rtn,1)
resi=m2$residuals
mq(resi, adj=9)   # plot not shown
m3=VARchi(rtn,p=1,thres=1.96)   #  Number of targeted parameters: 6
m1=VAR(rtn,1) # fit a un-constrained VAR(1) model.
m2=refVAR(m1,thres=1.96) # Model refinement.
resi=m2$residuals
### Model checking
mq(resi,adj=6)   #
MTSdiag(m2,adj=6)
VARpred(m2,8)  ## Using unconstrained model
## Impulse response functions Using the simplified model
Phi=m2$Phi
Sig=m2$Sigma
#VARirf(Phi,Sig)  #   Press return to continue
VARirf(Phi,Sig,orth=F) #      Press return to continue  ## Plots not shown
