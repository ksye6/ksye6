option ls=80 ps=80 nodate nonumber;
 TITLE1 'Time series plot of Original S&P: 1970-2000 monthly';
 

DATA  sap;
INPUT Y w  X;
logx=log( x );
dlogx=dif1(logx);
date=intnx( 'month', '1jan1970'd, _n_);
format date monyy.;
 CARDS;
 1970 01 85.280
 1970 02 90.034 
 1970 03 90.427
 1970 04 82.517
 1970 05 77.750
 1970 06 74.124
 1970 07 79.821
 1970 08 83.636
 1970 09 86.663
 1970 10 85.942
 1970 11 90.288
 1970 12 95.683
 1971 01 99.816
 1971 02 100.982
 1971 03 104.958
 1971 04 109.039
 1971 05 104.780
 1971 06 105.127
 1971 07 101.057
 1971 08 104.980
 1971 09 104.513
 1971 10 100.422
 1971 11 100.443
 1971 12 109.366
 1972 01 111.616
 1972 02 114.709
 1972 03 115.656
 1972 04 116.443
 1972 05 118.736
 1972 06 116.427
 1972 07 116.981
 1972 08 121.295
 1972 09 120.989
 1972 10 122.423
 1972 11 128.315
 1972 12 130.140
 1973 01 128.200
 1973 02 123.681
 1973 03 123.781
 1973 04 119.041
 1973 05 117.105
 1973 06 116.636
 1973 07 121.380
 1973 08 117.241
 1973 09 122.246
 1973 10 122.448
 1973 11 108.868
 1973 12 111.024
 1974 01 110.227
 1974 02 110.147
 1974 03 107.892
 1974 04 104.023
 1974 05 100.879
 1974 06 99.734
 1974 07 92.335
 1974 08 84.360
 1974 09 74.644
 1974 10 87.191
 1974 11 82.931
 1974 12 81.639
 1975 01 92.023
 1975 02 97.892
 1975 03 100.376
 1975 04 105.494
 1975 05 110.520
 1975 06 115.795
 1975 07 108.338
 1975 08 106.434
 1975 09 103.114
 1975 10 109.851
 1975 11 112.948
 1975 12 112.032
 1976 01 125.671
 1976 02 124.612
 1976 03 128.811
 1976 04 127.808
 1976 05 126.387
 1976 06 131.989
 1976 07 131.356
 1976 08 131.115
 1976 09 134.504
 1976 10 131.999
 1976 11 131.460
 1976 12 138.838
 1977 01 132.274
 1977 02 129.863
 1977 03 128.497
 1977 04 129.032
 1977 05 126.502
 1977 06 132.754
 1977 07 130.706
 1977 08 128.849
 1977 09 129.049
 1977 10 124.022
 1977 11 127.944
 1977 12 128.902
 1978 01 121.501
 1978 02 119.037
 1978 03 122.538
 1978 04 133.596
 1978 05 134.824
 1978 06 132.967
 1978 07 140.720
 1978 08 144.955
 1978 09 144.491
 1978 10 131.894
 1978 11 134.726
 1978 12 137.372
 1979 01 143.461
 1979 02 138.852
 1979 03 147.131
 1979 04 148.057
 1979 05 144.842
 1979 06 151.143
 1979 07 153.169
 1979 08 162.008
 1979 09 162.704
 1979 10 152.286
 1979 11 159.525
 1979 12 162.936
 1980 01 173.064
 1980 02 173.049
 1980 03 156.225
 1980 04 163.448
 1980 05 171.860
 1980 06 177.298
 1980 07 189.636
 1980 08 191.553
 1980 09 197.188
 1980 10 201.180
 1980 11 222.613
 1980 12 215.896
 1981 01 206.863
 1981 02 210.456
 1981 03 218.873
 1981 04 214.641
 1981 05 215.190
 1981 06 213.843
 1981 07 214.283
 1981 08 201.909
 1981 09 191.961
 1981 10 202.321
 1981 11 210.670
 1981 12 205.267
 1982 01 202.588
 1982 02 191.264
 1982 03 190.266
 1982 04 198.865
 1982 05 192.085
 1982 06 189.200
 1982 07 185.834
 1982 08 208.393
 1982 09 210.991
 1982 10 235.276
 1982 11 244.778
 1982 12 249.495
 1983 01 258.773
 1983 02 264.704
 1983 03 274.483
 1983 04 296.107
 1983 05 293.531
 1983 06 304.955
 1983 07 295.958
 1983 08 300.400
 1983 09 304.548
 1983 10 301.027
 1983 11 307.377
 1983 12 305.770
 1984 01 304.064
 1984 02 293.365
 1984 03 298.445
 1984 04 301.277
 1984 05 284.599
 1984 06 290.780
 1984 07 287.173
 1984 08 318.891
 1984 09 318.967
 1984 10 320.196
 1984 11 316.611
 1984 12 324.953
 1985 01 350.270
 1985 02 354.560
 1985 03 354.795
 1985 04 354.461
 1985 05 374.941
 1985 06 380.816
 1985 07 380.260
 1985 08 377.013
 1985 09 365.221
 1985 10 382.090
 1985 11 408.298
 1985 12 428.050
 1986 01 430.440
 1986 02 462.615
 1986 03 488.424
 1986 04 482.925
 1986 05 508.617
 1986 06 517.212
 1986 07 488.283
 1986 08 524.493
 1986 09 481.133
 1986 10 508.879
 1986 11 521.247
 1986 12 507.945
 1987 01 576.344
 1987 02 599.118
 1987 03 616.404
 1987 04 610.931
 1987 05 616.228
 1987 06 647.347
 1987 07 680.140
 1987 08 705.518
 1987 09 690.051
 1987 10 541.440
 1987 11 496.820
 1987 12 534.616
 1988 01 557.103
 1988 02 583.072
 1988 03 565.059
 1988 04 571.309
 1988 05 576.251
 1988 06 602.695
 1988 07 600.410
 1988 08 580.026
 1988 09 604.738
 1988 10 621.576
 1988 11 612.718
 1988 12 623.407
 1989 01 669.058
 1989 02 652.385
 1989 03 667.604
 1989 04 702.266
 1989 05 730.679
 1989 06 726.534
 1989 07 792.134
 1989 08 807.619
 1989 09 804.342
 1989 10 785.666
 1989 11 801.689
 1989 12 820.941
 1990 01 765.826
 1990 02 775.690
 1990 03 796.245
 1990 04 776.380
 1990 05 852.081
 1990 06 846.333
 1990 07 843.619
 1990 08 767.364
 1990 09 730.020
 1990 10 726.911
 1990 11 73.899
 1990 12 795.457
 1991 01 830.099
 1991 02 889.464
 1991 03 911.003
 1991 04 913.159
 1991 05 952.553
 1991 06 908.913
 1991 07 951.277
 1991 08 973.815
 1991 09 957.518
 1991 10 970.391
 1991 11 931.292
 1991 12 1037.800
 1992 01 1018.461
 1992 02 1031.650
 1992 03 1011.586
 1992 04 1041.338
 1992 05 1046.443
 1992 06 1030.875
 1992 07 1072.988
 1992 08 1051.028
 1992 09 1063.379
 1992 10 1067.052
 1992 11 1103.386
 1992 12 1116.927
 1993 01 1126.211
 1993 02 1141.561
 1993 03 1165.647
 1993 04 1137.472
 1993 05 1167.900
 1993 06 1171.320
 1993 07 1166.609
 1993 08 1210.873
 1993 09 1201.587
 1993 10 1226.443
 1993 11 1214.738
 1993 12 1229.425
 1994 01 1271.222
 1994 02 1236.718
 1994 03 1182.801
 1994 04 1197.969
 1994 05 1217.629
 1994 06 1187.782
 1994 07 1226.786
 1994 08 1235.899
 1994 09 1245.854
 1994 10 1273.843
 1994 11 1227.446
 1994 12 1245.659
 1995 01 1277.963
 1995 02 1327.767
 1995 03 1366.946
 1995 04 1407.198
 1995 05 1463.440
 1995 06 1497.432
 1995 07 1547.091
 1995 08 1550.981
 1995 09 1616.436
 1995 10 1610.658
 1995 11 1681.363
 1995 12 1713.749
 1996 01 1772.079
 1996 02 1788.509
 1996 03 1805.724
 1996 04 1832.347
 1996 05 1879.602
 1996 06 1886.773
 1996 07 1803.415
 1996 08 1841.456
 1996 09 1945.102
 1996 10 1998.750
 1996 11 2149.829
 1996 12 2107.231
 1997 01 2238.881
 1997 02 2256.428
 1997 03 2163.715
 1997 04 2292.885
 1997 05 2432.485
 1997 06 2541.465
 1997 07 2743.683
 1997 08 2589.977
 1997 09 2731.821
 1997 10 2640.585
 1997 11 2762.825
 1997 12 2810.273
 1998 01 2841.357
 1998 02 3046.290
 1998 03 3202.286
 1998 04 3234.503
 1998 05 3178.909
 1998 06 3308.033
 1998 07 3272.807
 1998 08 2799.633
 1998 09 2978.980
 1998 10 3221.295
 1998 11 3416.531
 1998 12 3613.409
 1999 01 3764.508
 1999 02 3647.511
 1999 03 3793.443
 1999 04 3940.345
 1999 05 3847.300
 1999 06 4060.816
 1999 07 3934.018
 1999 08 3914.555
 1999 09 3807.242
 1999 10 4048.167
 1999 11 4130.458
 1999 12 4373.726
 2000 01 4153.979
 2000 02 4075.346
 2000 03 4474.033
 2000 04 4339.428
 2000 05 4250.396
 2000 06 4355.181
 2000 07 4287.092
 2000 08 4553.382
 2000 09 4312.994
 2000 10 4294.759
 2000 11 3956.163
 2000 12 3975.525
;
RUN;


symbol1 i=join c=black v=none;
symbol2 i=join c=blue v=none;
symbol3 i=join c=blue v=none;

proc gplot data=sap;
plot x*date=1/ haxis='1jan1970'd to '1jan2000'd by year;
TITLE1 'Time series plot of Original S&P: 1970-2000 monthly';
run;

proc gplot data=sap;
plot logx*date=1/ haxis='1jan1970'd to '1jan2000'd by year;
TITLE1 'Time series plot of log(S&P): 1970-2000 monthly';
run;


proc gplot data=sap;
plot dlogx*date=3 / haxis='1jan1970'd to '1jan2000'd by year;
TITLE1 'Time series plot of log(S&P)(t)-log(S&P)(t-1): 1970-2000 monthly';

run;

proc arima data=sap;
identify var=logx ;
identify var=logx (1) nlag=15 ;
estimate p=3  method=cls;
estimate q=1   method=cls;


forecast outlimit=b lead=12 alpha=0.05 id=date interval=month noprint;



title1 'Forecasting by the final model';

 data c;
 set b;
 x=exp( logx ); 
 forecast=exp (forecast+STD*STD/2);
 l95=exp (l95);
 u95=exp (u95);
 run;

 /*
 proc print data=c;
 */

 symbol1  c=black v=plus;
 symbol2 i=join c=red v=star;
 symbol3 i=join c=blue v=none;; 


proc gplot data=c;
 where date >= ' 1jan90'd;
 plot x*date=1 forecast*date=2
    l95*date=3 u95*date=3/ 
	overlay haxis='1jan90'd to '1jan02'd by year;

run; 


