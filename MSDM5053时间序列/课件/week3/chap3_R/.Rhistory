m3
Box.test(sample,lag=6,type="Ljung")
Box.test(sample,lag=12,type="Ljung")
Box.test(sample,lag=24,type="Ljung")
###########################################
b=arima.sim(n = 1000, list(ar=c(0.6,0.3)))
plot(b,main=" ",ylab="",xlab="",type="l")
acf(b,20,main=expression(paste("AR(2) with ", phi[1]==0.6," and ",phi[2]==0.3)),col="red")
Box.test(b,lag=6,type="Ljung")
Box.test(b,lag=12,type="Ljung")
Box.test(b,lag=24,type="Ljung")
##########################################
#simulation for ARIMA
b=arima.sim(n = 1000, list(ar=0.8,order=c(1,1,0)))
plot(b,main=" ",ylab="",xlab="",type="l")
acf(b,20,main=expression(paste("ARIMA(1,1,0) models with ", phi[1]==0.8)),col="red")
pacf(b,20,main=expression(paste("ARIMA(1,1,0) models with ", phi[1]==0.8)),col="red")
db=diff(b)
plot(db,main=" ",ylab="",xlab="",type="l")
acf(db,20,main= "Differencing for ARIMA(1,1,0) models" ,col="red")
pacf(db,20,main= "Differencing for ARIMA(1,1,0) models",col="red")
b=arima.sim(n = 1000, list(ma=0.75,order=c(0,1,1)))
plot(b,main=" ",ylab="",xlab="",type="l")
acf(b,20,main=expression(paste("ARIMA(0,1,1) models with ", theta[1]==0.75)),col="red")
pacf(b,20,main=expression(paste("ARIMA(0,1,1) models with ", theta[1]==0.75)),col="red")
db=diff(b)
plot(db,main=" ",ylab="",xlab="",type="l")
acf(db,20,main= "Differencing for ARIMA(0,1,1) models" ,col="red")
pacf(db,20,main= "Differencing for ARIMA(0,1,1) models",col="red")
b=arima.sim(n = 1000, list(ar=0.9,ma=0.5,order=c(1,1,1)))
plot(b,main=" ",ylab="",xlab="",type="l")
acf(b,20,main=expression(paste("ARIMA(1,1,1) models with ", phi[1]==0.9, " and ",theta[1]==0.5)),col="red")
pacf(b,20,main=expression(paste("ARIMA(1,1,1) models with ", phi[1]==0.9, " and ",theta[1]==0.5)),col="red")
db=diff(b)
plot(b,main=" ",ylab="",xlab="",type="l")
acf(db,20,main= "Differencing for ARIMA(1,1,1) models" ,col="red")
pacf(db,20,main= "Differencing for ARIMA(1,1,1) models",col="red")
#   ar1      ar2      ar3  intercept
# 0.1158  -0.0187  -0.1042     0.0089
# s.e.  0.0315   0.0317   0.0317     0.0017
#
# sigma^2 estimated as 0.002875:  log likelihood = 1500.86,  aic = -2991.73
(1-.1158+.0187+.1042)*mean(vw) # Compute the intercept phi(0).
#0.008967611
sqrt(m3$sigma2) # Compute standard error of residuals
#0.0536189
Box.test(m3$residuals,lag=12,type="Ljung")
# Box-Ljung test
#
# data:  m3$residuals
# X-squared = 16.352, df = 12, p-value = 0.1756
pv=1-pchisq(16.352,9) #Compute p-value using 9 degrees of freedom
pv
# [1] 0.05988496
#To fix the AR(2) coef to zero:
m3=arima(vw,order=c(3,0,0),fixed=c(NA,0,NA,NA))
# The subcommand ¡¯fixed¡¯ is used to fix parameter values, where NA denotes estimation and 0 means fixing the
#parameter to 0. The ordering of the parameters can be found using m3$coef.
m3
# Call:
#   arima(x = vw, order = c(3, 0, 0), fixed = c(NA, 0, NA, NA))
#
# Coefficients:
#   ar1  ar2      ar3  intercept
# 0.1136    0  -0.1063     0.0089
# s.e.  0.0313    0   0.0315     0.0017
#
# sigma^2 estimated as 0.002876:  log likelihood = 1500.69,  aic = -2993.38
(1-.1136+.1063)*.0089 # Compute phi(0)
#0.00883503
sqrt(m3$sigma2) # Compute residual standard error
#0.05362832
Box.test(m3$residuals,lag=12,type="Ljung")
# Box-Ljung test
#
# data:  m3$residuals
# X-squared = 16.828, df = 12, p-value = 0.1562
pv=1-pchisq(16.828,10)
pv
#0.0782576
vw=read.table("D:/User/Desktop/2016Fall_UG/Notes2016Fall/data/m-ibm3dx2608.txt",header=T)[,3]
length(vw)#996
vw1=vw[1:984]
ar3=arima(vw1,order=c(3,0,0))
ar3
# Call:
#   arima(x = vw1, order = c(3, 0, 0))
#
# Coefficients:
#   ar1      ar2      ar3  intercept
# 0.1034  -0.0201  -0.1089     0.0095
# s.e.  0.0317   0.0318   0.0317     0.0017
#
# sigma^2 estimated as 0.00284:  log likelihood = 1488.85,  aic = -2967.71
sqrt(ar3$sigma2) # Compute standard error of residuals
#0.05328902
fore=predict(ar3,12)
U=append(vw[984],fore$pred+1.96*fore$se)
L=append(vw[984],fore$pred-1.96*fore$se)
p=vw[985:996]
plot(1:24,vw[973:996],ylim=c(-0.2,0.2),type="o",ylab="",xlab="",main="Forecasting")
lines(12:24,append(vw[984],fore$pred),type="o",col="red")
lines(12:24, U,type="l",col="blue")
lines(12:24, L,type="l",col="blue")
#points(temp.date[2:7],p,type="o")
legend(x="topleft",c("True returns","prediction"),lty=c(1,1),pch=c(1,1),col=c("black","red"))
b=arima.sim(n = 1000, list(ar=c(0.6,0.3)))
acf(b,20,main=expression(paste("AR(2) with ", phi[1]==0.6," and ",phi[2]==0.3)),col="red")
pacf(b,20,main=expression(paste("AR(2) with ", phi[1]==0.6," and ",phi[2]==0.3)),col="red")
b=arima.sim(n = 1000, list(ar=c(0.7,-0.2,-0.3)))
acf(b,20,main=expression(paste("AR(3) with ", phi=="(0.7,-0.2,-0.3)" )),col="red")
pacf(b,20,main=expression(paste("AR(3) with ", phi=="(0.7,-0.2,-0.3)" )),col="red")
phi1 <- seq(from = -2.5, to = 2.5, length = 51)
plot(phi1,1+phi1,lty="dashed",type="l",xlab="",ylab="",cex.axis=.8,ylim=c(-1.2,1.2))
abline(a = -1, b = 0, lty="dashed")
abline(a = 1, b = -1, lty="dashed")
title(ylab=expression(phi[2]),xlab=expression(phi[1]),cex.lab=.8)
polygon(x = phi1[6:46], y = 1-abs(phi1[6:46]), col="gray")
lines(phi1,-phi1^2/4)
text(0,-.5,expression(phi[2]< -phi[1]^2/4),cex=.7)
text(1.2,.5,expression(phi[2]>1-phi[1]),cex=.7)
text(-1.75,.5,expression(phi[2]>1+phi[1]),cex=.7)
vw=read.table("D:/User/Desktop/2016Fall_UG/Notes2016Fall/data/m-ibm3dx2608.txt",header=T)[,3]
plot(vw,main=" ",ylab="",xlab="",type="l")
#acf(vw,20)
pacf(vw,12,ylim=c(-0.2,0.2),main="")
pacf(vw,12,ylim=c(-0.2,0.2),main="")
m3=arima(vw,order=c(3,0,0))
m3
vw=read.table("C:/ling/teaching/teaching/MSBD5006MSDM5053/Lecture-3/chap3_R/m-ibm3dx2608.txt",header=T)[,3]
plot(vw,main=" ",ylab="",xlab="",type="l")
#acf(vw,20)
pacf(vw,12,ylim=c(-0.2,0.2),main="")
m3=arima(vw,order=c(3,0,0))
m3
(1-.1158+.0187+.1042)*mean(vw) # Compute the intercept phi(0).
#0.008967611
sqrt(m3$sigma2) # Compute standard error of residuals
#0.0536189
Box.test(m3$residuals,lag=12,type="Ljung")
# Box-Ljung test
#
# data:  m3$residuals
# X-squared = 16.352, df = 12, p-value = 0.1756
pv=1-pchisq(16.352,9) #Compute p-value using 9 degrees of freedom
pv
# [1] 0.05988496
m3=arima(vw,order=c(3,0,0),fixed=c(NA,0,NA,NA))
# The subcommand ¡¯fixed¡¯ is used to fix parameter values, where NA denotes estimation and 0 means fixing the
#parameter to 0. The ordering of the parameters can be found using m3$coef.
m3
vw=read.table("C:/ling/teaching/teaching/MSBD5006MSDM5053/Lecture-3/chap3_R/m-ibm3dx2608.txt",header=T)[,3]
plot(vw,main=" ",ylab="",xlab="",type="l")
#acf(vw,20)
pacf(vw,12,ylim=c(-0.2,0.2),main="")
Box.test(vw,lag=12,type="Ljung")
m3=arima(vw,order=c(3,0,0))
m3
# Call:
#   arima(x = vw, order = c(3, 0, 0))
#
# Coefficients:
#   ar1      ar2      ar3  intercept
# 0.1158  -0.0187  -0.1042     0.0089
# s.e.  0.0315   0.0317   0.0317     0.0017
#
# sigma^2 estimated as 0.002875:  log likelihood = 1500.86,  aic = -2991.73
(1-.1158+.0187+.1042)*mean(vw) # Compute the intercept phi(0).
#0.008967611
sqrt(m3$sigma2) # Compute standard error of residuals
#0.0536189
Box.test(m3$residuals,lag=12,type="Ljung")
# Box-Ljung test
#
# data:  m3$residuals
# X-squared = 16.352, df = 12, p-value = 0.1756
pv=1-pchisq(16.352,9) #Compute p-value using 9 degrees of freedom
pv
# [1] 0.05988496
#To fix the AR(2) coef to zero:
m3=arima(vw,order=c(3,0,0),fixed=c(NA,0,NA,NA))
# The subcommand ¡¯fixed¡¯ is used to fix parameter values, where NA denotes estimation and 0 means fixing the
#parameter to 0. The ordering of the parameters can be found using m3$coef.
m3
# Call:
#   arima(x = vw, order = c(3, 0, 0), fixed = c(NA, 0, NA, NA))
#
# Coefficients:
#   ar1  ar2      ar3  intercept
# 0.1136    0  -0.1063     0.0089
# s.e.  0.0313    0   0.0315     0.0017
#
# sigma^2 estimated as 0.002876:  log likelihood = 1500.69,  aic = -2993.38
(1-.1136+.1063)*.0089 # Compute phi(0)
#0.00883503
sqrt(m3$sigma2) # Compute residual standard error
#0.05362832
Box.test(m3$residuals,lag=12,type="Ljung")
# Box-Ljung test
vw=read.table("C:/ling/teaching/teaching/MSBD5006MSDM5053/Lecture-3/chap3_R/m-ibm3dx2608.txt",header=T)[,3]
length(vw)#996
vw1=vw[1:984]
Box.test(vw1,lag=12,type="Ljung")
ar3=arima(vw1,order=c(3,0,0))
ar3
# Call:
#   arima(x = vw1, order = c(3, 0, 0))
#
# Coefficients:
#   ar1      ar2      ar3  intercept
# 0.1034  -0.0201  -0.1089     0.0095
# s.e.  0.0317   0.0318   0.0317     0.0017
#
# sigma^2 estimated as 0.00284:  log likelihood = 1488.85,  aic = -2967.71
sqrt(ar3$sigma2) # Compute standard error of residuals
#0.05328902
fore=predict(ar3,12)
fore
U=append(vw[984],fore$pred+1.96*fore$se)
L=append(vw[984],fore$pred-1.96*fore$se)
p=vw[985:996]
plot(1:24,vw[973:996],ylim=c(-0.2,0.2),type="o",ylab="",xlab="",main="Forecasting")
lines(12:24,append(vw[984],fore$pred),type="o",col="red")
lines(12:24, U,type="l",col="blue")
lines(12:24, L,type="l",col="blue")
#points(temp.date[2:7],p,type="o")
legend(x="topleft",c("True returns","prediction"),lty=c(1,1),pch=c(1,1),col=c("black","red"))
vw=read.table("C:/ling/teaching/teaching/MSBD5006MSDM5053/Lecture-3/chap3_R/m-ibm3dx2608.txt",header=T)[,3]
length(vw)#996
vw1=vw[1:984]
Box.test(vw1,lag=12,type="Ljung")
ar3=arima(vw1,order=c(3,0,0))
ar3
# Call:
#   arima(x = vw1, order = c(3, 0, 0))
#
# Coefficients:
#   ar1      ar2      ar3  intercept
# 0.1034  -0.0201  -0.1089     0.0095
# s.e.  0.0317   0.0318   0.0317     0.0017
#
# sigma^2 estimated as 0.00284:  log likelihood = 1488.85,  aic = -2967.71
sqrt(ar3$sigma2) # Compute standard error of residuals
#0.05328902
fore=predict(ar3,12)
fore
U=append(vw[984],fore$pred+1.96*fore$se)
L=append(vw[984],fore$pred-1.96*fore$se)
p=vw[985:996]
plot(1:24,vw[973:996],ylim=c(-0.2,0.2),type="o",ylab="",xlab="",main="Forecasting")
lines(12:24,append(vw[984],fore$pred),type="o",col="red")
lines(12:24, U,type="l",col="blue")
lines(12:24, L,type="l",col="blue")
#points(temp.date[2:7],p,type="o")
legend(x="topleft",c("True returns","prediction"),lty=c(1,1),pch=c(1,1),col=c("black","red"))
vw=read.table("C:/ling/teaching/teaching/MSBD5006MSDM5053/Lecture-3/chap3_R/m-ibm3dx2608.txt",header=T)[,3]
length(vw)#996
vw1=vw[1:984]
Box.test(vw1,lag=12,type="Ljung")
vw=read.table("C:/ling/teaching/teaching/MSBD5006MSDM5053/Lecture-3/chap3_R/m-ibm3dx2608.txt",header=T)[,3]
length(vw)#996
vw1=vw[1:984]
Box.test(vw1,lag=12,type="Ljung")
vw=read.table("C:/ling/teaching/teaching/MSBD5006MSDM5053/chap3_R/m-ibm3dx2608.txt",header=T)[,3]
plot(vw,main=" ",ylab="",xlab="",type="l")
acf(vw,20)
pacf(vw,12,ylim=c(-0.2,0.2),main="")
m3=arima(vw,order=c(3,0,0))
m3
m3=arima(vw,order=c(3,0,0))
m3
(1-.1158+.0187+.1042)*mean(vw)
sqrt(m3$sigma2) # Compute standard error of residuals
#0.0536189
Box.test(m3$residuals,lag=12,type="Ljung")
# Box-Ljung test
pv=1-pchisq(16.352,9) #Compute p-value using 9 degrees of freedom
pv
#
vw=read.table("C:/ling/teaching/teaching/MSBD5006MSDM5053/R/m-ibm3dx2608.txt",header=T)[,3]
length(vw)#996
vw1=vw[1:984]
ar3=arima(vw1,order=c(3,0,0))
ar3
# Call:
#   arima(x = vw1, order = c(3, 0, 0))
#
# Coefficients:
#   ar1      ar2      ar3  intercept
# 0.1034  -0.0201  -0.1089     0.0095
# s.e.  0.0317   0.0318   0.0317     0.0017
#
# sigma^2 estimated as 0.00284:  log likelihood = 1488.85,  aic = -2967.71
sqrt(ar3$sigma2) # Compute standard error of residuals
#0.05328902
fore=predict(ar3,12)
U=append(vw[984],fore$pred+1.96*fore$se)
L=append(vw[984],fore$pred-1.96*fore$se)
p=vw[985:996]
plot(1:24,vw[973:996],ylim=c(-0.2,0.2),type="o",ylab="",xlab="",main="Forecasting")
lines(12:24,append(vw[984],fore$pred),type="o",col="red")
lines(12:24, U,type="l",col="blue")
lines(12:24, L,type="l",col="blue")
#points(temp.date[2:7],p,type="o")
legend(x="topleft",c("True returns","prediction"),lty=c(1,1),pch=c(1,1),col=c("black","red"))
vw=read.table("C:/ling/teaching/teaching/MSBD5006MSDM5053/Lecture-3/chap3_R/m-ibm3dx2608.txt",header=T)[,3]
plot(vw,main=" ",ylab="",xlab="",type="l")
#acf(vw,20)
pacf(vw,12,ylim=c(-0.2,0.2),main="")
Box.test(vw,lag=12,type="Ljung")
m3=arima(vw,order=c(3,0,0))
m3
#
(1-.1158+.0187+.1042)*mean(vw) # Compute the intercept phi(0).
#0.008967611
sqrt(m3$sigma2) # Compute standard error of residuals
#0.0536189
Box.test(m3$residuals,lag=12,type="Ljung")
# Box-Ljung test
#
pv=1-pchisq(16.352,9) #Compute p-value using 9 degrees of freedom
pv
#
m3=arima(vw,order=c(3,0,0),fixed=c(NA,0,NA,NA))
m3=arima(vw,order=c(3,0,0),fixed=c(NA,0,NA,NA))
# The subcommand ¡¯fixed¡¯ is used to fix parameter values, where NA denotes estimation and 0 means fixing the
#parameter to 0. The ordering of the parameters can be found using m3$coef.
m3
#
# sigma^2 estimated as 0.002876:  log likelihood = 1500.69,  aic = -2993.38
(1-.1136+.1063)*.0089 # Compute phi(0)
#0.00883503
sqrt(m3$sigma2) # Compute residual standard error
#0.05362832
Box.test(m3$residuals,lag=12,type="Ljung")
#
# X-squared = 16.828, df = 12, p-value = 0.1562
pv=1-pchisq(16.828,10)
pv
#
b=arima.sim(n = 1000, list(ma=c(-0.5)))
plot(b,main=" ",ylab="",xlab="",type="l")
acf(b,20,main=expression(paste("ma(1) with ", theta[1]==-0.5)),col="red")
pacf(b,20,main=expression(paste("ma(1) models with ", theta[1]==-0.5)),col="red")
b=arima.sim(n = 1000, list(ma=c(1.5)))
plot(b,main=" ",ylab="",xlab="",type="l")
acf(b,20,main=expression(paste("ma(1) with ", theta[1]==-0.5)),col="red")
pacf(b,20,main=expression(paste("ma(1) models with ", theta[1]==-0.5)),col="red")
b=arima.sim(n = 1000, list(ma=c(0.5, -0.3)))
plot(b,main=" ",ylab="",xlab="",type="l")
acf(b,20,main=expression(paste("ma(2) with ", theta[1]==0.5,  theta[2]==-0.3)),col="red")
pacf(b,20,main=expression(paste("ma(2) models with ", theta[1]==0.5, theta[2]==-0.3)),col="red")
b=arima.sim(n = 1000, list(ma=c(0.5, 0.3)))
plot(b,main=" ",ylab="",xlab="",type="l")
acf(b,20,main=expression(paste("ma(2) with ", theta[1]==0.5,  theta[2]==-0.3)),col="red")
pacf(b,20,main=expression(paste("ma(2) models with ", theta[1]==0.5, theta[2]==-0.3)),col="red")
##MA(1) model
###################################
b=arima.sim(n = 1000, list(ma=c(0.5)))
plot(b,main=" ",ylab="",xlab="",type="l")
acf(b,20,main=expression(paste("ma(1) with ", theta[1]==-0.5)),col="red")
pacf(b,20,main=expression(paste("ma(1) models with ", theta[1]==-0.5)),col="red")
b=arima.sim(n = 1000, list(ar=c(0.9, -0.0), ma=-0.5))
plot(b,main=" ",ylab="",xlab="",type="l")
acf(b,20,main=expression(paste("ARMA "),),col="red")
pacf(b,20,main=expression(paste("ARMA "),),col="red")
b=arima.sim(n = 1000, list(ar=c(0.9, -0.0), ma=-0.5))
plot(b,main=" ",ylab="",xlab="",type="l")
acf(b,20,main=expression(paste("ARMA "),),col="red")
pacf(b,20,main=expression(paste("ARMA "),),col="red")
b=arima.sim(n = 1000, list(ar=c(0.9, -0.0), ma=0.5))
plot(b,main=" ",ylab="",xlab="",type="l")
acf(b,20,main=expression(paste("ARMA "),),col="red")
pacf(b,20,main=expression(paste("ARMA "),),col="red")
b=arima.sim(n = 1000, list(ar=c(0.9, -0.0), ma=0.5))
plot(b,main=" ",ylab="",xlab="",type="l")
acf(b,20,main=expression(paste("ARMA "),),col="red")
pacf(b,20,main=expression(paste("ARMA "),),col="red")
b=arima.sim(n = 1000, list(ar=c(0.9, -0.5), ma=-0.5))
plot(b,main=" ",ylab="",xlab="",type="l")
acf(b,20,main=expression(paste("ARMA "),),col="red")
pacf(b,20,main=expression(paste("ARMA "),),col="red")
install.packages(c("quantmod", "stochvol"))
#simulation for AR(1) model
data=function(n,theta){
m=200
noise=rnorm(n+m)
r=numeric(m+n)
for (i in 2:(m+n))
r[i]=theta[1]+theta[2]*r[i-1]+noise[i]
return(r[-(1:m)])
}
n=1000
#theta=c(0.5,0.2)
theta=c(0.0,0.8)
sample=data(n,theta)
sample[1]
sample[2]
sample[3]
plot(sample,main=" ",ylab="",xlab="",type="l")
acf(sample,10,main=expression(paste("AR(1) with ", phi[1]==0.8)),col="red")
Box.test(sample,lag=6,type="Ljung")
Box.test(sample,lag=12,type="Ljung")
Box.test(sample,lag=24,type="Ljung")
###########################################
b=arima.sim(n = 1000, list(ar=c(0.6,0.3)))
plot(b,main=" ",ylab="",xlab="",type="l")
acf(b,20,main=expression(paste("AR(2) with ", phi[1]==0.6," and ",phi[2]==0.3)),col="red")
Box.test(b,lag=6,type="Ljung")
Box.test(b,lag=12,type="Ljung")
Box.test(b,lag=24,type="Ljung")
b=arima.sim(n = 1000, list(ar=0.8,order=c(1,1,0)))
plot(b,main=" ",ylab="",xlab="",type="l")
acf(b,20,main=expression(paste("ARIMA(1,1,0) models with ", phi[1]==0.8)),col="red")
pacf(b,20,main=expression(paste("ARIMA(1,1,0) models with ", phi[1]==0.8)),col="red")
b=arima.sim(n = 500, model = list(order = c(0, 1, 0)), mean=0)
plot(b,main=" ",ylab="",xlab="",type="l")
acf(b,20,main="Random walk",col="red")
pacf(b,20,main="Random walk",col="red")
b=arima.sim(n = 500, model = list(order = c(0, 1, 0)), mean=0.4)
plot(b,main=" ",ylab="",xlab="",type="l")
acf(b,20,main="Random walk with drift",col="red")
pacf(b,20,main="Random walk with drift",col="red")
b=arima.sim(n = 1000, list(ar=c(0.6,0.3)))
plot(b,main=" ",ylab="",xlab="",type="l")
Box.test(b,lag=6,type="Ljung")
Box.test(b,lag=12,type="Ljung")
Box.test(b,lag=24,type="Ljung")
acf(b,20,main=expression(paste("AR(2) with ", phi[1]==0.6," and ",phi[2]==0.3)),col="red")
pacf(b,20,main=expression(paste("AR(2) with ", phi[1]==0.6," and ",phi[2]==0.3)),col="red")
b=arima.sim(n = 1000, list(ar=c(0.7,-0.2,-0.3)))
plot(b,main=" ",ylab="",xlab="",type="l")
acf(b,20,main=expression(paste("AR(3) with ", phi=="(0.7,-0.2,-0.3)" )),col="red")
pacf(b,20,main=expression(paste("AR(3) with ", phi=="(0.7,-0.2,-0.3)" )),col="red")
phi1 <- seq(from = -2.5, to = 2.5, length = 51)
plot(phi1,1+phi1,lty="dashed",type="l",xlab="",ylab="",cex.axis=.8,ylim=c(-1.2,1.2))
abline(a = -1, b = 0, lty="dashed")
abline(a = 1, b = -1, lty="dashed")
title(ylab=expression(phi[2]),xlab=expression(phi[1]),cex.lab=.8)
polygon(x = phi1[6:46], y = 1-abs(phi1[6:46]), col="gray")
lines(phi1,-phi1^2/4)
text(0,-.5,expression(phi[2]< -phi[1]^2/4),cex=.7)
text(1.2,.5,expression(phi[2]>1-phi[1]),cex=.7)
text(-1.75,.5,expression(phi[2]>1+phi[1]),cex=.7)
phi1 <- seq(from = -2.5, to = 2.5, length = 51)
plot(phi1,1+phi1,lty="dashed",type="l",xlab="",ylab="",cex.axis=.8,ylim=c(-1.2,1.2))
abline(a = -1, b = 0, lty="dashed")
abline(a = 1, b = -1, lty="dashed")
title(ylab=expression(phi[2]),xlab=expression(phi[1]),cex.lab=.8)
polygon(x = phi1[6:46], y = 1-abs(phi1[6:46]), col="gray")
lines(phi1,-phi1^2/4)
text(0,-.5,expression( 4 phi[2]+phi[1]^2<0),cex=.7)
text(1.2,.5,expression(phi[2]+phi[1]>1),cex=.7)
text(-1.75,.5,expression(phi[2]-phi[1]>1),cex=.7)
phi1 <- seq(from = -2.5, to = 2.5, length = 51)
plot(phi1,1+phi1,lty="dashed",type="l",xlab="",ylab="",cex.axis=.8,ylim=c(-1.2,1.2))
abline(a = -1, b = 0, lty="dashed")
abline(a = 1, b = -1, lty="dashed")
title(ylab=expression(phi[2]),xlab=expression(phi[1]),cex.lab=.8)
polygon(x = phi1[6:46], y = 1-abs(phi1[6:46]), col="gray")
lines(phi1,-phi1^2/4)
text(0,-.5,expression( 4phi[2]+phi[1]^2<0),cex=.7)
text(1.2,.5,expression(phi[2]+phi[1]>1),cex=.7)
text(-1.75,.5,expression(phi[2]-phi[1]>1),cex=.7)
phi1 <- seq(from = -2.5, to = 2.5, length = 51)
plot(phi1,1+phi1,lty="dashed",type="l",xlab="",ylab="",cex.axis=.8,ylim=c(-1.2,1.2))
abline(a = -1, b = 0, lty="dashed")
abline(a = 1, b = -1, lty="dashed")
title(ylab=expression(phi[2]),xlab=expression(phi[1]),cex.lab=.8)
polygon(x = phi1[6:46], y = 1-abs(phi1[6:46]), col="gray")
lines(phi1,-phi1^2/4)
text(0,-.5,expression(phi[2]+phi[1]^2/4<0),cex=.7)
text(1.2,.5,expression(phi[2]+phi[1]>1),cex=.7)
text(-1.75,.5,expression(phi[2]-phi[1]>1),cex=.7)
vw=read.table("C:/ling/teaching/teaching/MSBD5006MSDM5053/Lecture-3/chap3_R/m-ibm3dx2608.txt",header=T)[,3]
plot(vw,main=" ",ylab="",xlab="",type="l")
#acf(vw,20)
pacf(vw,12,ylim=c(-0.2,0.2),main="")
Box.test(vw,lag=12,type="Ljung")
m3=arima(vw,order=c(3,0,0))
m3
(1-.1158+.0187+.1042)*mean(vw) # Compute the intercept phi(0).
#0.008967611
sqrt(m3$sigma2) # Compute standard error of residuals
#0.0536189
Box.test(m3$residuals,lag=12,type="Ljung")
# Box-Ljung test
#
# data:  m3$residuals
# X-squared = 16.352, df = 12, p-value = 0.1756
pv=1-pchisq(16.352,9) #Compute p-value using 9 degrees of freedom
pv
m3=arima(vw,order=c(3,0,0),fixed=c(NA,0,NA,NA))
# The subcommand ¡¯fixed¡¯ is used to fix parameter values, where NA denotes estimation and 0 means fixing the
#parameter to 0. The ordering of the parameters can be found using m3$coef.
m3
m3=arima(vw,order=c(3,0,0),fixed=c(NA,0,NA,NA))
vw=read.table("C:/ling/teaching/teaching/MSBD5006MSDM5053/Lecture-3/chap3_R/m-ibm3dx2608.txt",header=T)[,3]
plot(vw,main=" ",ylab="",xlab="",type="l")
#acf(vw,20)
pacf(vw,12,ylim=c(-0.2,0.2),main="")
Box.test(vw,lag=12,type="Ljung")
m3=arima(vw,order=c(3,0,0))
m3
m3=arima(vw,order=c(3,0,0),fixed=c(NA,0,NA,NA))
# The subcommand ¡¯fixed¡¯ is used to fix parameter values, where NA denotes estimation and 0 means fixing the
#parameter to 0. The ordering of the parameters can be found using m3$coef.
m3
m3=arima(vw,order=c(3,0,0),fixed=c(NA,0,NA,0))
# The subcommand ¡¯fixed¡¯ is used to fix parameter values, where NA denotes estimation and 0 means fixing the
#parameter to 0. The ordering of the parameters can be found using m3$coef.
m3
